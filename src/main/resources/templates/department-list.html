<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="#{department.list.title}">진료과 목록</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body class="bg-light d-flex flex-column min-vh-100">

<div th:replace="fragments/header :: header"></div>

<div class="container py-5 flex-grow-1" style="margin-top: 100px;">

  <h3 class="mb-4" th:text="#{department.list.title}">진료과 목록</h3>

  <div class="table-responsive">
    <table class="table table-bordered align-middle text-center">
      <thead class="table-light">
      <tr>
        <th th:text="#{department.name}">진료과명</th>
        <th th:text="#{manage}">관리</th>
      </tr>
      </thead>

      <!-- ✅ 진료과가 있을 때만 출력 -->
      <tbody th:if="${departments != null and !departments.isEmpty()}">
      <tr th:each="dept : ${departments}">
        <!-- ✅ 현재 locale이 en이면 nameEn, 아니면 name 출력 -->
        <td th:text="${#locale.language == 'en' ? dept.nameEn : dept.name}"></td>

        <td>
          <a class="btn btn-sm btn-outline-primary me-1"
             th:href="@{'/departments/edit/' + ${dept.id}}">
            <i class="bi bi-pencil-square"></i> <span th:text="#{edit}">수정</span>
          </a>
          <form th:action="@{'/departments/delete/' + ${dept.id}}"
                method="post"
                style="display:inline;"
                th:onsubmit="|return confirm('#{department.delete.confirm}');|">
            <button type="submit" class="btn btn-sm btn-outline-danger">
              <i class="bi bi-trash"></i> <span th:text="#{delete}">삭제</span>
            </button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>

    <!-- ✅ 진료과가 없을 때 메시지 출력 -->
    <div th:if="${departments == null or departments.isEmpty()}" class="text-center py-4 text-muted">
      <i class="bi bi-info-circle"></i>
      <span th:text="#{department.empty}">진료과가 없습니다.</span>
    </div>
  </div>


  <!-- 추가 버튼 -->
  <a class="btn btn-success mt-3" th:href="@{/departments/add}">
    <i class="bi bi-plus-circle"></i> <span th:text="#{department.add}">진료과 추가</span>
  </a>

</div>

<div th:replace="fragments/footer :: footer"></div>

</body>
</html>
